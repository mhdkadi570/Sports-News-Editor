<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ğŸ“° Ù…ÙˆÙ„Ù‘Ø¯ Ø£Ø®Ø¨Ø§Ø± ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…</title>
  <style>
    body { font-family: Tahoma, sans-serif; margin: 20px; background: #f9f9f9; }
    h1 { color: #333; }
    select, button, textarea { margin-top: 10px; display: block; }
    select, button { padding: 8px; }
    textarea { width: 100%; height: 220px; }
  </style>
</head>
<body>
  <h1>ğŸ“° Ù…Ø­Ø±Ø± Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª</h1>

  <label>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©:</label>
  <select id="matches"></select>
  <button onclick="generateNews()">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®Ø¨Ø±</button>

  <h2>Ø§Ù„Ù†Øµ Ø§Ù„Ù†Ø§ØªØ¬:</h2>
  <textarea id="newsOutput"></textarea>

  <script>
    const apiKey = "YOUR_API_KEY_HERE"; // Ø¶Ø¹ Ù…ÙØªØ§Ø­Ùƒ Ù‡Ù†Ø§

    // Ø¬Ù„Ø¨ Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ… ÙˆØ§Ù„Ø£Ù…Ø³
    async function loadMatches() {
      const today = new Date();
      const yesterday = new Date();
      yesterday.setDate(today.getDate() - 1);

      const formatDate = d => d.toISOString().split("T")[0];

      const urls = [
        `https://v3.football.api-sports.io/fixtures?date=${formatDate(today)}`,
        `https://v3.football.api-sports.io/fixtures?date=${formatDate(yesterday)}`
      ];

      let allMatches = [];

      for (let url of urls) {
        const res = await fetch(url, { headers: { "x-apisports-key": apiKey } });
        const data = await res.json();
        allMatches = allMatches.concat(data.response);
      }

      const select = document.getElementById("matches");
      allMatches.forEach(m => {
        const opt = document.createElement("option");
        opt.value = m.fixture.id;
        opt.textContent = `${m.teams.home.name} vs ${m.teams.away.name} (${m.league.name})`;
        select.appendChild(opt);
      });
    }

    // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø®Ø¨Ø±
    async function generateNews() {
      const matchId = document.getElementById("matches").value;

      try {
        const res = await fetch(`https://v3.football.api-sports.io/fixtures?id=${matchId}`, {
          headers: { "x-apisports-key": apiKey }
        });
        const data = await res.json();
        const match = data.response[0];

        const league = match.league.name;
        const round = match.league.round;
        const home = match.teams.home.name;
        const away = match.teams.away.name;
        const goalsHome = match.goals.home;
        const goalsAway = match.goals.away;

        // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©
        const eventsRes = await fetch(`https://v3.football.api-sports.io/fixtures/events?fixture=${matchId}`, {
          headers: { "x-apisports-key": apiKey }
        });
        const eventsData = await eventsRes.json();

        let goalsText = "";
        let redCards = "";

        eventsData.response.forEach(ev => {
          if (ev.type === "Goal") {
            goalsText += `${ev.player.name} Ø³Ø¬Ù„ ÙÙŠ Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© ${ev.time.elapsed}. `;
          }
          if (ev.type === "Card" && ev.detail === "Red Card") {
            redCards += `Ø¨Ø·Ø§Ù‚Ø© Ø­Ù…Ø±Ø§Ø¡ Ù„Ù€ ${ev.player.name} ÙÙŠ Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© ${ev.time.elapsed}. `;
          }
        });

        // Ø§Ù„ØªØ±ØªÙŠØ¨
        const standingsRes = await fetch(`https://v3.football.api-sports.io/standings?league=${match.league.id}&season=${match.league.season}`, {
          headers: { "x-apisports-key": apiKey }
        });
        const standingsData = await standingsRes.json();
        const table = standingsData.response[0].league.standings[0];
        const homeRank = table.find(t => t.team.id === match.teams.home.id)?.rank;
        const awayRank = table.find(t => t.team.id === match.teams.away.id)?.rank;

        // Ù‚ÙˆØ§Ù„Ø¨ Ù…ØªØ¹Ø¯Ø¯Ø©
        const templates = [
          `ÙÙŠ ${round} Ù…Ù† ${league}ØŒ Ø§Ù†ØªÙ‡Øª Ù…ÙˆØ§Ø¬Ù‡Ø© ${home} Ùˆ${away} Ø¨Ù†ØªÙŠØ¬Ø© ${goalsHome}-${goalsAway}. ${goalsText}${redCards}Ø¨Ø¹Ø¯ Ø§Ù„Ù„Ù‚Ø§Ø¡ØŒ ${home} ÙÙŠ Ø§Ù„Ù…Ø±ÙƒØ² ${homeRank} Ùˆ${away} ÙÙŠ Ø§Ù„Ù…Ø±ÙƒØ² ${awayRank}.`,
          `Ø¹Ù„Ù‰ Ø£Ø±Ø¶ ${home}ØŒ Ø§Ø³ØªØ¶Ø§Ù Ø§Ù„ÙØ±ÙŠÙ‚ ${away} Ø¶Ù…Ù† ${round} Ù…Ù† ${league}. Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø© Ø§Ù†ØªÙ‡Øª ${goalsHome}-${goalsAway}. ${goalsText}${redCards}Ø¨Ù‡Ø°Ø§ØŒ ${home} ÙŠØ­ØªÙ„ Ø§Ù„Ù…Ø±ÙƒØ² ${homeRank} Ø¨ÙŠÙ†Ù…Ø§ ${away} ÙÙŠ Ø§Ù„Ù…Ø±ÙƒØ² ${awayRank}.`,
          `Ø´Ù‡Ø¯Øª Ø§Ù„Ø¬ÙˆÙ„Ø© ${round} Ù…Ù† ${league} Ù…Ø¨Ø§Ø±Ø§Ø© Ø¨ÙŠÙ† ${home} Ùˆ${away} Ø§Ù†ØªÙ‡Øª Ø¨Ù†ØªÙŠØ¬Ø© ${goalsHome}-${goalsAway}. ${goalsText}${redCards}Ø§Ù„ØªØ±ØªÙŠØ¨ Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©: ${home} ÙÙŠ Ø§Ù„Ù…Ø±ÙƒØ² ${homeRank} Ùˆ${away} ÙÙŠ Ø§Ù„Ù…Ø±ÙƒØ² ${awayRank}.`
        ];

        // Ø§Ø®ØªÙŠØ§Ø± Ù‚Ø§Ù„Ø¨ Ø¹Ø´ÙˆØ§Ø¦ÙŠ
        const news = templates[Math.floor(Math.random() * templates.length)];

        document.getElementById("newsOutput").value = news;

      } catch (err) {
        document.getElementById("newsOutput").value = "Ø­Ø¯Ø« Ø®Ø·Ø£: " + err;
      }
    }

    loadMatches();
  </script>
</body>
</html>
